<template>
  <header class="bg-white shadow fixed w-full z-10">
    <div class="mx-auto py-4 px-6 flex justify-between items-center max-w-300">
      <router-link to="/">
        <svg
          class="w-35 hover:cursor-pointer"
          viewBox="0 -7.59 320 154.79"
          xmlns="http://www.w3.org/2000/svg"
          fill="#0f0f0f"
          stroke="#0f0f0f"
          transform="rotate(0)"
        >
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g
            id="SVGRepo_tracerCarrier"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke="#CCCCCC"
            stroke-width="13.00236"
          >
            <g
              id="movie_ticket"
              data-name="movie ticket"
              transform="translate(-517.238 -128.444)"
            >
              <path
                id="Path_4483"
                data-name="Path 4483"
                d="M528.737,170.978l-10.13,14.781a7.885,7.885,0,0,0,2.04,10.929l17.983,12.326a5.554,5.554,0,0,1,9.159,6.278l74.993,51.4a7.887,7.887,0,0,0,10.931-2.041l10.1-14.733a13.752,13.752,0,0,1,15.548-22.685l11.3-16.487a7.887,7.887,0,0,0-2.04-10.931l-75.037-51.427a4.715,4.715,0,0,1-.315.578,5.569,5.569,0,0,1-9.186-6.3,4.772,4.772,0,0,1,.425-.5l-18.024-12.354a7.885,7.885,0,0,0-10.93,2.042l-11.333,16.536a13.754,13.754,0,0,1-15.482,22.587Zm51.7-13.137a5.569,5.569,0,1,1-7.743,1.446A5.572,5.572,0,0,1,580.434,157.841ZM569.043,174.46A5.569,5.569,0,1,1,561.3,175.9,5.565,5.565,0,0,1,569.043,174.46Zm-11.389,16.617a5.569,5.569,0,1,1-7.741,1.445A5.569,5.569,0,0,1,557.654,191.077Z"
                fill="#847edd"
              ></path>
              <g id="Group_1918" data-name="Group 1918">
                <path
                  id="Path_4484"
                  data-name="Path 4484"
                  d="M527.48,242.279V260.2a7.885,7.885,0,0,0,7.863,7.862h21.8a5.554,5.554,0,0,1,11.1,0h90.919a7.884,7.884,0,0,0,7.861-7.862V242.336a13.751,13.751,0,0,1,0-27.5V194.848a7.885,7.885,0,0,0-7.861-7.863H568.2a5.266,5.266,0,0,1,.066.656,5.569,5.569,0,1,1-11.137,0,5.458,5.458,0,0,1,.066-.656H535.343a7.886,7.886,0,0,0-7.863,7.863V214.9a13.754,13.754,0,0,1,0,27.383ZM562.7,202.218a5.569,5.569,0,1,1-5.569,5.568A5.568,5.568,0,0,1,562.7,202.218Zm0,20.146a5.569,5.569,0,1,1-5.569,5.568A5.568,5.568,0,0,1,562.7,222.364Zm0,20.145a5.569,5.569,0,1,1-5.569,5.569A5.568,5.568,0,0,1,562.7,242.509Z"
                  fill="#6569d7"
                ></path>
                <path
                  id="Path_4485"
                  data-name="Path 4485"
                  d="M527.48,242.279V260.2a7.885,7.885,0,0,0,7.863,7.862h21.8a5.559,5.559,0,0,1,5.552-5.4v-9.007a5.569,5.569,0,0,1,0-11.139V233.5a5.569,5.569,0,1,1,0-11.138v-9.008a5.569,5.569,0,1,1,0-11.138V193.21a5.571,5.571,0,0,1-5.569-5.569,5.458,5.458,0,0,1,.066-.656H535.343a7.886,7.886,0,0,0-7.863,7.863V214.9a13.754,13.754,0,0,1,0,27.383Z"
                  fill="#6f60cd"
                ></path>
                <path
                  id="Path_4486"
                  data-name="Path 4486"
                  d="M578.91,253.648a2.621,2.621,0,0,1,2.621-2.622h69.337a2.623,2.623,0,0,1,2.621,2.622h0a2.62,2.62,0,0,1-2.621,2.618H581.531a2.619,2.619,0,0,1-2.621-2.618Z"
                  fill="#847edd"
                ></path>
                <path
                  id="Path_4487"
                  data-name="Path 4487"
                  d="M578.91,202.218a2.621,2.621,0,0,1,2.621-2.621h69.337a2.622,2.622,0,0,1,2.621,2.621h0a2.621,2.621,0,0,1-2.621,2.619H581.531a2.619,2.619,0,0,1-2.621-2.619Z"
                  fill="#847edd"
                ></path>
                <g id="Group_1917" data-name="Group 1917">
                  <g id="Group_1916" data-name="Group 1916">
                    <path
                      id="Path_4488"
                      data-name="Path 4488"
                      d="M607.839,234.345a5.327,5.327,0,0,0-1.247-3.945l-5.154-5.395c-.873-.913-.566-1.836.682-2.043l7.359-1.225a5.314,5.314,0,0,0,3.366-2.407l3.539-6.567c.6-1.115,1.57-1.109,2.154.016l3.439,6.62a5.317,5.317,0,0,0,3.33,2.457l7.337,1.336c1.248.227,1.541,1.152.653,2.055l-5.235,5.316a5.325,5.325,0,0,0-1.308,3.924l1,7.394c.17,1.257-.62,1.82-1.753,1.254l-6.674-3.335a5.324,5.324,0,0,0-4.138-.03L608.466,243c-1.142.55-1.922-.026-1.735-1.28Z"
                      fill="#847edd"
                    ></path>
                  </g>
                </g>
              </g>
            </g>
          </g>
          <g id="SVGRepo_iconCarrier">
            <g
              id="movie_ticket"
              data-name="movie ticket"
              transform="translate(-517.238 -128.444)"
            >
              <path
                id="Path_4483"
                data-name="Path 4483"
                d="M528.737,170.978l-10.13,14.781a7.885,7.885,0,0,0,2.04,10.929l17.983,12.326a5.554,5.554,0,0,1,9.159,6.278l74.993,51.4a7.887,7.887,0,0,0,10.931-2.041l10.1-14.733a13.752,13.752,0,0,1,15.548-22.685l11.3-16.487a7.887,7.887,0,0,0-2.04-10.931l-75.037-51.427a4.715,4.715,0,0,1-.315.578,5.569,5.569,0,0,1-9.186-6.3,4.772,4.772,0,0,1,.425-.5l-18.024-12.354a7.885,7.885,0,0,0-10.93,2.042l-11.333,16.536a13.754,13.754,0,0,1-15.482,22.587Zm51.7-13.137a5.569,5.569,0,1,1-7.743,1.446A5.572,5.572,0,0,1,580.434,157.841ZM569.043,174.46A5.569,5.569,0,1,1,561.3,175.9,5.565,5.565,0,0,1,569.043,174.46Zm-11.389,16.617a5.569,5.569,0,1,1-7.741,1.445A5.569,5.569,0,0,1,557.654,191.077Z"
                fill="#847edd"
              ></path>
              <g id="Group_1918" data-name="Group 1918">
                <path
                  id="Path_4484"
                  data-name="Path 4484"
                  d="M527.48,242.279V260.2a7.885,7.885,0,0,0,7.863,7.862h21.8a5.554,5.554,0,0,1,11.1,0h90.919a7.884,7.884,0,0,0,7.861-7.862V242.336a13.751,13.751,0,0,1,0-27.5V194.848a7.885,7.885,0,0,0-7.861-7.863H568.2a5.266,5.266,0,0,1,.066.656,5.569,5.569,0,1,1-11.137,0,5.458,5.458,0,0,1,.066-.656H535.343a7.886,7.886,0,0,0-7.863,7.863V214.9a13.754,13.754,0,0,1,0,27.383ZM562.7,202.218a5.569,5.569,0,1,1-5.569,5.568A5.568,5.568,0,0,1,562.7,202.218Zm0,20.146a5.569,5.569,0,1,1-5.569,5.568A5.568,5.568,0,0,1,562.7,222.364Zm0,20.145a5.569,5.569,0,1,1-5.569,5.569A5.568,5.568,0,0,1,562.7,242.509Z"
                  fill="#6569d7"
                ></path>
                <path
                  id="Path_4485"
                  data-name="Path 4485"
                  d="M527.48,242.279V260.2a7.885,7.885,0,0,0,7.863,7.862h21.8a5.559,5.559,0,0,1,5.552-5.4v-9.007a5.569,5.569,0,0,1,0-11.139V233.5a5.569,5.569,0,1,1,0-11.138v-9.008a5.569,5.569,0,1,1,0-11.138V193.21a5.571,5.571,0,0,1-5.569-5.569,5.458,5.458,0,0,1,.066-.656H535.343a7.886,7.886,0,0,0-7.863,7.863V214.9a13.754,13.754,0,0,1,0,27.383Z"
                  fill="#6f60cd"
                ></path>
                <path
                  id="Path_4486"
                  data-name="Path 4486"
                  d="M578.91,253.648a2.621,2.621,0,0,1,2.621-2.622h69.337a2.623,2.623,0,0,1,2.621,2.622h0a2.62,2.62,0,0,1-2.621,2.618H581.531a2.619,2.619,0,0,1-2.621-2.618Z"
                  fill="#847edd"
                ></path>
                <path
                  id="Path_4487"
                  data-name="Path 4487"
                  d="M578.91,202.218a2.621,2.621,0,0,1,2.621-2.621h69.337a2.622,2.622,0,0,1,2.621,2.621h0a2.621,2.621,0,0,1-2.621,2.619H581.531a2.619,2.619,0,0,1-2.621-2.619Z"
                  fill="#847edd"
                ></path>
                <g id="Group_1917" data-name="Group 1917">
                  <g id="Group_1916" data-name="Group 1916">
                    <path
                      id="Path_4488"
                      data-name="Path 4488"
                      d="M607.839,234.345a5.327,5.327,0,0,0-1.247-3.945l-5.154-5.395c-.873-.913-.566-1.836.682-2.043l7.359-1.225a5.314,5.314,0,0,0,3.366-2.407l3.539-6.567c.6-1.115,1.57-1.109,2.154.016l3.439,6.62a5.317,5.317,0,0,0,3.33,2.457l7.337,1.336c1.248.227,1.541,1.152.653,2.055l-5.235,5.316a5.325,5.325,0,0,0-1.308,3.924l1,7.394c.17,1.257-.62,1.82-1.753,1.254l-6.674-3.335a5.324,5.324,0,0,0-4.138-.03L608.466,243c-1.142.55-1.922-.026-1.735-1.28Z"
                      fill="#847edd"
                    ></path>
                  </g>
                </g>
              </g>
            </g>
          </g>
          <text
            x="160"
            y="134"
            font-size="40"
            fill="#847edd"
            font-family="Arial"
            font-weight="bold"
          >
            Cinema
          </text>
        </svg>
      </router-link>
      <el-select
        class="space-x-4 text-lg font-bold"
        v-model="value"
        @change="handleChangeCinema"
        :placeholder="
          cinemaStore.cinemas.length > 0
            ? cinemaStore.cinemas[0].cinemaName
            : 'Loading...'
        "
        style="width: 240px"
      >
        <el-option
          v-for="item in cinemaStore.cinemas"
          :key="item.id"
          :label="item.cinemaName"
          :value="item.id"
        />
      </el-select>
      <button @click="toggleMenu" class="md:hidden">
        <svg
          class="w-6 h-6 cursor-pointer"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16m-7 6h7"
          />
        </svg>
      </button>
      <nav class="hidden md:flex space-x-4 text-lg font-bold">
        <router-link
          v-for="(link, index) in navLinks"
          :key="index"
          :to="link.url"
          class="text-[var(--text-color)] hover:text-[var(--primary-color)]"
        >
          {{ link.text }}
        </router-link>
        <router-link
          v-if="!isLogin"
          to="/login"
          class="text-[var(--text-color)] hover:text-[var(--primary-color)]"
          >Đăng nhập <i class="fa-solid fa-right-to-bracket ml-1"></i
        ></router-link>
        <router-link
          @click="logout"
          v-else
          to=""
          class="text-[var(--text-color)] hover:text-[var(--primary-color)]"
          >Đăng xuất <i class="fa-solid fa-right-to-bracket ml-1"></i
        ></router-link>
      </nav>
      <!-- Mobile menu -->
      <div
        v-if="isOpen"
        class="absolute top-full left-0 w-full bg-white shadow-md md:hidden cursor-pointer z-10"
      >
        <router-link
          v-for="(link, index) in navLinks"
          :key="index"
          :to="link.url"
          class="block px-6 py-2 border-b text-gray-700 hover:bg-gray-100"
          >{{ link.text }}</router-link
        >
        <router-link
          v-if="!isLogin"
          to="/login"
          class="block px-6 py-2 border-b text-gray-700 hover:bg-gray-100"
          >Đăng nhập</router-link
        >
        <router-link
          v-else
          @click="logout"
          to=""
          class="block px-6 py-2 border-b text-gray-700 hover:bg-gray-100"
          >Đăng xuất</router-link
        >
      </div>
    </div>
  </header>
</template>
<script setup>
import { onMounted, ref } from "vue";
import { useCinemaStore } from "../store/cinemaStore";
import { useRouter } from "vue-router";

// data
const isLogin = ref(false);
const navLinks = [
  { text: "Trang chủ", url: "/" },
  { text: "Lịch chiếu theo rạp", url: "/Showtimes" },
  { text: "Phim", url: "/Movies" },
  { text: "Tài khoản", url: "/UserInfo" },
];
const value = ref("");
const isOpen = ref(false);
const cinemaStore = useCinemaStore();
const router = useRouter();

// Method
const toggleMenu = () => {
  isOpen.value = !isOpen.value;
};
const checkLogin = () => {
  if (localStorage.getItem("authToken")) {
    isLogin.value = true;
  }
};

const logout = () => {
  localStorage.removeItem("authToken");
  localStorage.removeItem("userInfo");
  router.push("/");
  isLogin.value = false;
};

const handleChangeCinema = (newValue) => {
  cinemaStore.selectedCinema = newValue;
};

// moundted
onMounted(() => {
  checkLogin();
  // cinemaStore.fetchCinemas();
});
</script>
<style scoped>
::v-deep(.el-select__wrapper) {
  border-radius: 12px !important; /* Bo góc */
  outline: none !important; /* Xóa viền focus */
}
::v-deep(.is-focused) {
  box-shadow: inset;
}
</style>
